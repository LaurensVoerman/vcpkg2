From 7e4c9e36f6647ad0bdd1d24db97a850f3c6fa1f7 Mon Sep 17 00:00:00 2001
From: LaurensVoerman <l.voerman@rug.nl>
Date: Fri, 28 Nov 2025 17:15:00 +0100
Subject: [PATCH] daeFix

---
 src/osgPlugins/dae/CMakeLists.txt | 28 +++++++++++++++++++++++-----
 1 file changed, 23 insertions(+), 5 deletions(-)

diff --git a/src/osgPlugins/dae/CMakeLists.txt b/src/osgPlugins/dae/CMakeLists.txt
index af03fb8..c1f5332 100644
--- a/src/osgPlugins/dae/CMakeLists.txt
+++ b/src/osgPlugins/dae/CMakeLists.txt
@@ -39,15 +39,22 @@ SET(TARGET_H
     ReaderWriterDAE.h
 )
 
+IF(VCPKG_LIBRARY_LINKAGE)
+find_package(Boost COMPONENTS filesystem system REQUIRED)
+ENDIF()
 
-IF(COLLADA_DYNAMIC_LIBRARY AND COLLADA_STATIC_LIBRARY)
-    OPTION(COLLADA_USE_STATIC "Set to ON to build OpenSceneGraph with static Collada support." OFF)
-ELSEIF(COLLADA_STATIC_LIBRARY)
+if(VCPKG_LIBRARY_LINKAGE STREQUAL "static")
     SET(COLLADA_USE_STATIC "YES")
 ELSE()
-    SET(COLLADA_USE_STATIC "NO")
+	IF(COLLADA_DYNAMIC_LIBRARY AND COLLADA_STATIC_LIBRARY)
+		OPTION(COLLADA_USE_STATIC "Set to ON to build OpenSceneGraph with static Collada support." OFF)
+	ELSEIF(COLLADA_STATIC_LIBRARY)
+		SET(COLLADA_USE_STATIC "YES")
+	ELSE()
+		SET(COLLADA_USE_STATIC "NO")
+	ENDIF()
 ENDIF()
-
+MESSAGE("COLLADA_USE_STATIC ${COLLADA_USE_STATIC}")
 ADD_DEFINITIONS(-DNO_BOOST)
 ADD_DEFINITIONS(-DCOLLADA_DOM_SUPPORT141)
 
@@ -58,6 +65,16 @@ ENDIF()
 IF(COLLADA_USE_STATIC)
     IF(WIN32)
         ADD_DEFINITIONS(-DBOOST_ALL_NO_LIB)
+		IF(VCPKG_LIBRARY_LINKAGE)
+		SET(TARGET_LIBRARIES_VARS
+            COLLADA_DYNAMIC_LIBRARY
+            COLLADA_LIBXML_LIBRARY
+            COLLADA_ZLIB_LIBRARY
+            COLLADA_MINIZIP_LIBRARY
+			Boost_FILESYSTEM_LIBRARY
+			Boost_SYSTEM_LIBRARY
+			)
+		ELSE()
         SET(TARGET_LIBRARIES_VARS
             COLLADA_STATIC_LIBRARY
             COLLADA_LIBXML_LIBRARY
@@ -67,6 +84,7 @@ IF(COLLADA_USE_STATIC)
             COLLADA_MINIZIP_LIBRARY
             COLLADA_BOOST_FILESYSTEM_LIBRARY
             COLLADA_BOOST_SYSTEM_LIBRARY)
+		ENDIF()
     ELSE()
         SET(TARGET_LIBRARIES_VARS
             COLLADA_STATIC_LIBRARY
-- 
2.51.0.windows.2

